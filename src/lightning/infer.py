same functionality as in fasta2/predict.py